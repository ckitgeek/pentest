Multiple versions of Windows grant non-administrative users read access to files in the %windir%\system32\config directory. This can allow for local privilege escalation (LPE).


#Check
icacls c:\Windows\System32\config\SECURITY
icacls c:\Windows\System32\config\SAM
icacls c:\Windows\System32\config\SYSTEM


#Solution
icacls %windir%\system32\config\*.* /inheritance:e
vssadmin delete shadows /for=%systemdrive% /Quiet
